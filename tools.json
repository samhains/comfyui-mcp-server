{
  "description": "Tool definitions for ComfyUI MCP Server. Each tool defines how to interact with ComfyUI workflows.",
  "tools": {
    "generate_image": {
      "description": "Generates images using Flux model through ComfyUI",
      "workflow_id": "flux-dev-workflow",
      "model": "flux1-dev-fp8.safetensors",
      "parameters": {
        "prompt": {
          "required": true,
          "type": "string",
          "description": "Text description of the image to generate"
        },
        "width": {
          "required": false,
          "type": "integer",
          "description": "Image width in pixels"
        },
        "height": {
          "required": false,
          "type": "integer", 
          "description": "Image height in pixels"
        }
      },
      "workflow_mapping": {
        "description": "Maps parameters to ComfyUI workflow nodes",
        "prompt": ["6", "text"],
        "width": ["27", "width"],
        "height": ["27", "height"],
        "model": ["30", "ckpt_name"]
      }
    },
    "generate_video": {
      "description": "Generates videos using WAN 2.2 T2V workflow through ComfyUI",
      "workflow_id": "wan2.2-t2v-sd",
      "parameters": {
        "prompt": {
          "required": true,
          "type": "string",
          "description": "Text description of the video content to generate"
        },
        "audio_prompt": {
          "required": true,
          "type": "string",
          "description": "Text description of the audio/sound to generate for the video"
        },
        "frame_length": {
          "required": false,
          "type": "integer",
          "description": "Number of frames for the video. Defaults to config value if not specified."
        },
        "width": {
          "required": false,
          "type": "integer",
          "description": "Video width in pixels. Defaults to config value if not specified."
        },
        "height": {
          "required": false,
          "type": "integer",
          "description": "Video height in pixels. Defaults to config value if not specified."
        }
      },
      "workflow_mapping": {
        "description": "Maps parameters to ComfyUI workflow nodes",
        "prompt": ["141", "value"],
        "audio_prompt": ["147", "value"],
        "frame_length": ["145", "value"],
        "width": ["143", "value"],
        "height": ["144", "value"]
      },
      "notes": [
        "This workflow generates both video and audio using MMAudio",
        "The audio prompt is embedded in the workflow itself",
        "Video includes frame interpolation using RIFE",
        "Output format is MP4 with embedded audio"
      ]
    },
    "remix_image": {
      "description": "Generates images using 2 input images with Flux Redux style conditioning through ComfyUI",
      "workflow_id": "flux-2-redux",
      "parameters": {
        "image1_url": {
          "required": true,
          "type": "string",
          "description": "URL to the first reference image for style conditioning. Must be a valid HTTP/HTTPS URL pointing to an image file (JPG, PNG, etc.)."
        },
        "image2_url": {
          "required": true,
          "type": "string",
          "description": "URL to the second reference image for style conditioning. Must be a valid HTTP/HTTPS URL pointing to an image file (JPG, PNG, etc.)."
        },
        "width": {
          "required": false,
          "type": "integer",
          "description": "Image width in pixels. Defaults to 720 if not specified."
        },
        "height": {
          "required": false,
          "type": "integer",
          "description": "Image height in pixels. Defaults to 720 if not specified."
        }
      },
      "workflow_mapping": {
        "description": "Maps parameters to ComfyUI workflow nodes",
        "image1_url": ["69", "url_or_path"],
        "image2_url": ["70", "url_or_path"],
        "width": ["62", "value"],
        "height": ["65", "value"]
      },
      "output_node": {
        "node_id": "9",
        "class_type": "SaveImage",
        "title": "SAVE_IMAGE",
        "output_type": "image"
      },
      "notes": [
        "This workflow uses Flux Redux for style conditioning with 2 reference images",
        "Images are downloaded from URLs and processed through CLIP Vision encoding",
        "The workflow applies dual style conditioning before generating the final image",
        "Output is a single image that blends styles from both input images"
      ]
    },
    "generate_3_image_video": {
      "description": "Generates videos using 3 input image URLs with Flux Redux and WAN 2.2 I2V workflow through ComfyUI. Passes 3 image URLs to LoadImageFromUrlOrPath nodes (@IMAGE_1, @IMAGE_2, @IMAGE_3) for style conditioning, then generates video with WAN 2.2 image-to-video and MMAudio for synchronized audio.",
      "workflow_id": "flux-3-redux-wan2.2-i2v-sd",
      "parameters": {
        "image1_url": {
          "required": true,
          "type": "string",
          "description": "URL to the first reference image. This image will be used as the primary style reference for Flux Redux conditioning. Must be a valid HTTP/HTTPS URL pointing to an image file (JPG, PNG, etc.)."
        },
        "image2_url": {
          "required": true,
          "type": "string", 
          "description": "URL to the second reference image. This image will be used as additional style conditioning for Flux Redux. Must be a valid HTTP/HTTPS URL pointing to an image file (JPG, PNG, etc.)."
        },
        "image3_url": {
          "required": true,
          "type": "string",
          "description": "URL to the third reference image. This image will be used as additional style conditioning for Flux Redux. Must be a valid HTTP/HTTPS URL pointing to an image file (JPG, PNG, etc.)."
        },
        "frame_length": {
          "required": false,
          "type": "integer",
          "description": "Number of frames for the video. Defaults to workflow configuration (150 frames). Higher values create longer videos but take more time to process."
        },
        "width": {
          "required": false,
          "type": "integer",
          "description": "Video width in pixels. Defaults to workflow configuration (1280px). Must be compatible with the model requirements."
        },
        "height": {
          "required": false,
          "type": "integer",
          "description": "Video height in pixels. Defaults to workflow configuration (720px). Must be compatible with the model requirements."
        }
      },
      "workflow_mapping": {
        "description": "Maps parameters to ComfyUI workflow nodes",
        "image1_url": ["243", "url_or_path"],
        "image2_url": ["248", "url_or_path"],
        "image3_url": ["249", "url_or_path"],
        "frame_length": ["145", "value"],
        "width": ["143", "value"],
        "height": ["144", "value"]
      },
      "output_node": {
        "node_id": "125",
        "class_type": "VHS_VideoCombine",
        "title": "SAVE_VIDEO",
        "output_type": "video",
        "format": "video/h264-mp4"
      },
      "notes": [
        "This workflow combines Flux Redux (3-image style conditioning) + WAN 2.2 I2V + MMAudio",
        "Uses LoadImageFromUrlOrPath nodes to load images directly from URLs (@IMAGE_1, @IMAGE_2, @IMAGE_3)",
        "The workflow generates an intermediate styled image using Flux Redux, then converts to video", 
        "Automatic prompt generation using Qwen2.5VL for motion and audio prompts",
        "Video includes frame interpolation using RIFE for smooth motion",
        "Output format is MP4 with embedded audio generated by MMAudio",
        "Uses hardcoded output node 125 (SAVE_VIDEO) for reliable video output",
        "Processing time depends on frame_length and resolution settings"
      ],
      "api_integration": {
        "description": "Instructions for agents accessing this tool",
        "image_requirements": {
          "format": "URLs must point to valid image files (JPG, PNG, WebP, etc.)",
          "accessibility": "URLs must be publicly accessible or include proper authentication headers",
          "size": "Images will be automatically resized to fit workflow requirements",
          "processing": "Images are downloaded temporarily during workflow execution"
        },
        "example_call": {
          "image1_url": "https://your-storage.supabase.co/bucket/images/style1.jpg",
          "image2_url": "https://your-storage.supabase.co/bucket/images/style2.jpg", 
          "image3_url": "https://your-storage.supabase.co/bucket/images/style3.jpg",
          "prompt": "A dynamic scene transitions from static to animated, with characters moving through a vibrant environment",
          "audio_prompt": "Upbeat electronic music with ambient spatial effects and character movement sounds",
          "frame_length": 120,
          "width": 1280,
          "height": 720
        },
        "error_handling": [
          "Invalid URLs will return error before workflow execution",
          "Inaccessible images will cause workflow failure",
          "Large images may cause memory issues - consider resizing before upload",
          "Network timeouts during download will abort the workflow"
        ]
      }
    }
  },
  "workflow_files": {
    "description": "Location of ComfyUI workflow JSON files",
    "directory": "workflows/",
    "naming_convention": "{workflow-name}.json",
    "examples": {
      "flux-dev-workflow": "workflows/flux-dev-workflow.json",
      "mmaudio-workflow": "workflows/mmaudio-workflow.json"
    }
  },
  "adding_new_tools": {
    "description": "Steps to add a new tool/workflow",
    "steps": [
      "1. Create workflow JSON file in workflows/ directory",
      "2. Add tool definition to this file (tools.json)",
      "3. Define workflow_mapping for parameter routing",
      "4. Update WORKFLOW_MAPPINGS in comfyui_client.py",
      "5. Test the integration"
    ],
    "workflow_mapping_format": {
      "description": "Each parameter maps to [node_id, input_key] in workflow JSON",
      "example": {
        "prompt": ["6", "text"],
        "width": ["27", "width"]
      }
    }
  }
}
